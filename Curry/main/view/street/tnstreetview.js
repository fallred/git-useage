var searchdata=[
 {"篮球":[{"streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"儿童乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"小孩乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
             "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
             "streetname":"少年乐园",
            "streettype1":"运动",
             "streettype2":"篮球",
             "fans":"119",
             "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"成年乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"宝宝乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"童话乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"  
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"成年乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"宝宝乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"童话乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"  
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"成年乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"宝宝乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"童话乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"  
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"成年乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"宝宝乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"童话乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"  
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"成年乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"宝宝乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"童话乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"  
             }]
 },{"汪涵":[{"streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"儿童乐园1",
            "streettype1":"天天向上",
            "streettype2":"汪涵",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"小孩乐园1",
            "streettype1":"天天向上",
            "streettype2":"汪涵",
            "fans":"119",
            "invitation":"898"
             },{
             "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
             "streetname":"少年乐园1",
             "streettype1":"天天向上",
             "streettype2":"汪涵",
             "fans":"119",
             "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"成年乐园1",
            "streettype1":"天天向上",
            "streettype2":"汪涵",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"宝宝乐园1",
            "streettype1":"天天向上",
            "streettype2":"汪涵",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"童话乐园1",
             "streettype1":"天天向上",
             "streettype2":"汪涵",
            "fans":"119",
            "invitation":"898"  
             }]
         },
];
  var everyloaddata = [
            {"streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"儿童乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"小孩乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
             "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
             "streetname":"少年乐园",
            "streettype1":"运动",
             "streettype2":"篮球",
             "fans":"119",
             "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"成年乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"宝宝乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"童话乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"  
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"成年乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"宝宝乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"
             },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"童话乐园",
            "streettype1":"运动",
            "streettype2":"篮球",
            "fans":"119",
            "invitation":"898"  
             },
     ]; 
//我的街区
var currentstreetdata = {
    "lPhoto": "http://localhost:8080/Curry/images/userp.jpg",
    "streettype":"篮球吧",
    "classify":"运动 篮球",
    "introduce":"苟延残喘，总觉得自己做的还不够好。对自己，对别人，对时间。节市8所思源实验学校是由有关县（区）政府出资和香港言爱基金捐助新建的九年一贯制义务教育公办寄宿制学校，旨在整体迁移部分处于生态核心保护区和边远贫困地区的农村中小学生到该学校接受较高质量的义务教育，是一项教育移民扶贫工程，是贵州省委、省政府改善民生促进贵州经济社会发展的重点工程",
    "invitation":"999",
    "fans":"999",
    "focusstatus":true,
};
//热门街区数据
var hotstreetdata=[{
    "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
    "streetname":"儿童乐园",
    "streettype1":"运动",
     "streettype2":"篮球",
    "fans":"119",
    "invitation":"898"
   },{
    "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
    "streetname":"小孩乐园",
    "streettype1":"运动",
     "streettype2":"足球",
    "fans":"119",
    "invitation":"898"
   },{
    "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
    "streetname":"少年乐园",
    "streettype1":"运动",
     "streettype2":"乒乓球",
    "fans":"119",
    "invitation":"898"
   },{
    "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
    "streetname":"成年乐园",
    "streettype1":"运动",
     "streettype2":"桌球",
    "fans":"119",
    "invitation":"898"
    },{
    "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
    "streetname":"宝宝乐园",
    "streettype1":"运动",
     "streettype2":"唱歌",
    "fans":"119",
    "invitation":"898"
    },{
    "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
    "streetname":"童话乐园",
    "streettype1":"运动",
     "streettype2":"跑步",
    "fans":"119",
    "invitation":"898"  
    }];
var classifydata=[{
        "streettype1":"运动",
        "streettype2":[{
           "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
           "streetname":"童话乐园", 
           "fans":"119",
           "invitation":"898"    
           },{
           "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
           "streetname":"宝宝乐园", 
           "fans":"119",
           "invitation":"898" 
           },{
           "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
           "streetname":"成年乐园", 
           "fans":"119",
           "invitation":"898" 
           },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"小孩乐园",
            "fans":"119",
            "invitation":"898"
           },{
           "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
           "streetname":"成年乐园", 
           "fans":"119",
           "invitation":"898" 
           },{
            "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
            "streetname":"小孩乐园",
            "fans":"119",
            "invitation":"898"
           }]
        },{
            "streettype1":"学习",
            "streettype2":[{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"数学", 
               "fans":"119",
               "invitation":"898"    
               },{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"语文", 
               "fans":"119",
               "invitation":"898" 
               },{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"英语", 
               "fans":"119",
               "invitation":"898" 
               },{
                "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
                "streetname":"历史",
                "fans":"119",
                "invitation":"898"
               },{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"英语", 
               "fans":"119",
               "invitation":"898" 
                },{
                "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
                "streetname":"历史",
                "fans":"119",
                "invitation":"898"
               }]
       },{
            "streettype1":"游戏",
            "streettype2":[{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"客户端游戏", 
               "fans":"119",
               "invitation":"898"    
               },{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"网页游戏", 
               "fans":"119",
               "invitation":"898" 
               },{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"小游戏", 
               "fans":"119",
               "invitation":"898" 
               },{
                "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
                "streetname":"单机游戏",
                "fans":"119",
                "invitation":"898"
               },{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"小游戏", 
               "fans":"119",
               "invitation":"898" 
               },{
                "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
                "streetname":"单机游戏",
                "fans":"119",
                "invitation":"898"
               }]
       },{
            "streettype1":"学校",
            "streettype2":[{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"北京院校", 
               "fans":"119",
               "invitation":"898"    
               },{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"福建院校", 
               "fans":"119",
               "invitation":"898" 
               },{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"湖北院校", 
               "fans":"119",
               "invitation":"898" 
               },{
                "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
                "streetname":"四川院校",
                "fans":"119",
                "invitation":"898"
               },{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"上海院校", 
               "fans":"119",
               "invitation":"898" 
               },{
                "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
                "streetname":"苏州院校",
                "fans":"119",
                "invitation":"898"
               }]
       },{
            "streettype1":"娱乐明星",
            "streettype2":[{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"港台东南亚明星", 
               "fans":"119",
               "invitation":"898"    
               },{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"内地明星", 
               "fans":"119",
               "invitation":"898" 
               },{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"韩国明星", 
               "fans":"119",
               "invitation":"898" 
               },{
                "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
                "streetname":"欧美明星",
                "fans":"119",
                "invitation":"898"
               },{
               "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
               "streetname":"日本明星", 
               "fans":"119",
               "invitation":"898" 
               },{
                "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
                "streetname":"内地明星",
                "fans":"119",
                "invitation":"898"
               }]
       }];

//感兴趣街区数据
var intereststreetdata=[{
    "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
    "streetname":"儿童乐园",
    "streettype1":"运动",
     "streettype2":"篮球",
    "fans":"119",
    "invitation":"898"
   },{
    "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
    "streetname":"小孩乐园",
    "streettype1":"运动",
     "streettype2":"足球",
    "fans":"119",
    "invitation":"898"
   },{
    "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
    "streetname":"少年乐园",
    "streettype1":"运动",
     "streettype2":"乒乓球",
    "fans":"119",
    "invitation":"898"
   },{
    "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
    "streetname":"成年乐园",
    "streettype1":"运动",
     "streettype2":"桌球",
    "fans":"119",
    "invitation":"898"
    },{
    "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
    "streetname":"宝宝乐园",
    "streettype1":"运动",
     "streettype2":"唱歌",
    "fans":"119",
    "invitation":"898"
    },{
    "streetphoto":"http://localhost:8080/Curry/images/userpm.jpg",
    "streetname":"童话乐园",
    "streettype1":"运动",
     "streettype2":"跑步",
    "fans":"119",
    "invitation":"898"  
    }];
 //分类街区数据
/* var classifystreetdata=[{
    "classifyid":"entertainment",
    "streettype1":"娱乐明星",
    "streettype2":["港台东南亚明星","内地明星","韩国明星","欧美明星","日本明星","内地明星","欧美明星","韩国明星","港台东南亚明星"]
   },{
    "classifyid":"sports",
    "streettype1":"体育",
    "streettype2":["足球","篮球","羽毛球","健身"]
   },{
    "classifyid":"game",
    "streettype1":"游戏",
    "streettype2":["客户端游戏","网页游戏","小游戏","单机游戏","网页游戏","客户端游戏"]
   },{
    "classifyid":"school",
    "streettype1":"学校",
    "streettype2":["北京院校","福建院校","湖北院校","四川院校","上海院校","苏州院校"]
    }];*/
//童年街区
define(['backbone', 
	         'view/street/hotstreetview',
            'view/street/intereststreetview',
            'view/street/classifystreetview',
            'view/street/createstreetlayerview',
            'view/street/searchlistview',
            'view/street/streetblogcontentview',
            'view/street/currentstreetview',
            'view/street/mystreetview',
             'view/street/writeblogview',
             'view/street/streetmembertableview',
            'text!tpl/street/tnstreettpl.html',
            'text!tpl/street/createstreetsuccess.html',
            // 'view/street/tnstreetcontentview',
            // 'view/street/enterstreetview',
            // 'view/street/createstreetview', TnstreetContentView, EnterStreetView, CreateStreetView, 
            'global'], 
function(Backbone, HotStreetView, InterestStreetView, ClassifyStreetView,CreateStreetLayerView,SearchListView,StreetBlogContentView,CurrentStreetView,MyStreetView,WriteBlogView,StreetMemberTableView,tpl,createsuccesstpl,global) {
var self,flag;
var TnStreetView = Backbone.View.extend({
 el: "#container-fluid",
initialize: function(){
     self =this;
     this.$el.off();
},
containerBuild:function(){
      this.$el.addClass('');
	    this.$el.html(tpl);
},
events:{
  "click .tnstreetbtn .createStreet":"createStreet",
  "click .tnstreetmgbox .btn-search":"searchStreet",
  "click .tnstreetmgbox .enterStreet":"renderStreetIndex",
  "click .backmystreet":"showMyStreet",
  "click .categoryShow .classify2 .btn-r-r-md":"searchStreettype2",
  // "click .writeblog":"writeBlog",
  // "click .fans":"getStreetMember",
},
getStreetMember:function(){
    // render member info
   var smemberTableView = new StreetMemberTableView();
    memberdata.count = memberdata.length;
    smemberTableView.setData(memberdata);
    smemberTableView.containerBuild();
    smemberTableView.getAllData();
},
   /*写博客
writeBlog:function(){
    var container = $('<div class="category"></div><div class="categoryShow"></div>');
    this.$el.html(container);
    this.getCurrentStreet();
    this.renderEdit();
},*/
renderEdit:function(){
    var writeBlogView = new WriteBlogView();
    writeBlogView.render();
    writeBlogView.setParent(this);
    this.$el.append(writeBlogView.$el);
},
  /*街区主页*/
renderStreetIndex:function(){
    var container = $('<div class="category"></div><div class="categoryShow"></div>');
    this.$el.html(container);
    this.getCurrentStreet();
    this.getMessage();
    this.intercept();
},
//当前街区
getCurrentStreet:function(){
    var currentStreetView = new CurrentStreetView();
    currentStreetView.setModel(currentstreetdata);
    currentStreetView.setParent(self);
    // currentStreetView.setFlag(flag);
    currentStreetView.render();
   // this.$el.find(".category").html(currentStreetView.$el);
},
//获取当前街区的帖子
getMessage: function(){
    blogContentView = new StreetBlogContentView();
    blogContentView.setCollection(blogdata);
    blogContentView.render();
    this.$el.find(".categoryShow").html(blogContentView.$el);
},
 //内容截取
intercept : function() {
    $(".text-content").each(function(i,el) {
        var str = $(el).text();
        var name = str.substr(0,200);
        if (str.length > 200) {
            var newname = name + '...';
            $(this).text(newname);
        }else {
            $(this).text(str);
        }
    });
},
searchStreet:function(){
  /* var streettype=this.$el.find(".searchpanel input").val();
   var datalist=null;
   _.each(searchdata,function(o,index){  
      for(var attr in o){
         // alert('属性名是:'+attr+',对应的值是:'+o[attr]);//不能写成o.attr，如果写成0.attr就相当于o['attr']
          if(attr==streettype){
            datalist=o[attr];
           }
         }
   },this);*/
   var searchView = new SearchListView();
    searchView.setCollection(everyloaddata);
    searchView.render();
    // this.$el.find(".hotstreet .box-content-fluid").html(searchView.$el);
},
searchStreettype2:function(e){
   // var streettype=$(e.target).text;
   /*var streettype="汪涵";
   var datalist=null;
   _.each(searchdata,function(o,index){  
      for(var attr in o){
         // alert('属性名是:'+attr+',对应的值是:'+o[attr]);//不能写成o.attr，如果写成0.attr就相当于o['attr']
          if(attr==streettype){
            datalist=o[attr];
           }
         }
   },this);*/
    var searchView = new SearchListView();
    searchView.setCollection(everyloaddata);
    searchView.render();
    // this.$el.find(".hotstreet .box-content-fluid").html(searchView.$el);
},
createStreet:function(){
 //创建弹出框试图时先移除隐藏层
 // $(".addstreetmsg").remove();
  var createStreetLayerView = new CreateStreetLayerView({
        model: this.model
    });
   createStreetLayerView.setParent(this);
   createStreetLayerView.render();
},
//回到街区首页
showMyStreet:function(e){
   $(".street-item a").removeClass("itemback");
   $(".mystreet").addClass("itemback");
    var myStreetView = new MyStreetView();
    myStreetView.setParent(this);
    myStreetView.render();
    // alert("showMyStreet");
},
//点击创建街区弹框上的创建按钮，会出现一个创建成功，等待审核的页面，供createStreetLayerView里面调用
createSuccess:function(){
    var container = $('<div class="container-box full-screen fn-clear"></div>');
    this.$el.html(container);
    this.$el.find(".full-screen").html(createsuccesstpl);
    setTimeout(function(){
       self.showMyStreet();
    }, 3000);
},
render: function(){
 	this.containerBuild();
 	this.getHotStreet();
  this.getInterestStreet();
  this.getClassifyStreet();
},
getHotStreet:function(){
  var hotStreetView = new HotStreetView();
  hotStreetView.setCollection(hotstreetdata);
  hotStreetView.render();
  this.$el.find(".hotstreet .box-content-fluid").html(hotStreetView.$el);
},
getInterestStreet: function(){
	var interestStreetView = new InterestStreetView();
  interestStreetView.setCollection(intereststreetdata);
  interestStreetView.render();
  this.$el.find(".intereststreet .box-content-fluid").html(interestStreetView.$el);
},
getClassifyStreet: function(){
  var classifyStreetView = new ClassifyStreetView();
  classifyStreetView.setCollection(classifydata);
  classifyStreetView.render();
   	// this.$el.find(".classifystreet .box-content-fluid").append(classifyStreetView.$el);
}
});
return TnStreetView;
});